---
title: "Host-Pathogen Sharing Workflow Data"
author: "Emily M. Lachtara"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load required packages
library(dplyr)
library(ggplot2)
library(RColorBrewer)

# Define color pallette
mypal <- palette(brewer.pal(n = 10, name = "Set3"))
                 
# Load in data
load("data/final.genus.rda")
load("data/final.species.rda")
load("data/final.species.gen.rda")
load("data/final.genus.sp.rda")
load("data/raw/clean_pathogen.rda")
load("data/final.genus.p.rda")
load("data/path/genus.rda")
```

```{r Visualize WOS distribution}
# Genus WOS plot
p1 <- genus_genus %>%
  select(host, WOS) %>%
  distinct(host, .keep_all = TRUE) %>%
  ggplot(aes(x = log(WOS))) +
  geom_density(fill = mypal[9])+
  theme_minimal()+
  labs(y = "Count", x = "log(WOS Citations)")+
  labs(title = "WOS Citations by Genus")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/WOS/genus.pdf",
       plot = p1,
       units = "in",
       width = 3,
       height = 3,
       useDingbats = FALSE)

p2 <- species_species %>%
  select(host, WOS) %>%
  distinct(host, .keep_all = TRUE) %>%
  ggplot(aes(x = log(WOS))) +
  geom_density(fill = mypal[13])+
  theme_minimal()+
  labs(y = "Count", x = "log(WOS Citations)")+
  labs(title = "WOS Citations by Species")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")

ggsave("figures/WOS/species.pdf",
       plot = p2,
       units = "in",
       width = 2,
       height = 2,
       useDingbats = FALSE)
```

```{r Visualize log(WOS) vs log(PSR)}
# Genus plot
p2 <- genus_genus %>% 
  group_by(host) %>% 
  summarize(PSR = n(), WOS = WOS) %>%
  ggplot(aes(x = log(WOS), y = log(PSR))) +
  geom_point(col = mypal[9], size = 3)+
  geom_smooth(method = "lm", se = FALSE, size = 0.5, col = mypal[9])+
  theme_minimal()+
  labs(y = "log(PSR)", x = "log(WOS Citations)")+
  labs(title = "WOS Citations vs PSR (Genus)")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")

ggsave("figures/PSR/genus.pdf",
       plot = p2,
       units = "in",
       width = 4,
       height = 4,
       useDingbats = FALSE)


# Species plot
p1 <- species_species %>% 
  group_by(host) %>% 
  summarize(PSR = n(), WOS = WOS) %>%
  ggplot(aes(x = log(WOS), y = log(PSR))) +
  geom_point(col = mypal[13], size = 3)+
  geom_smooth(method = "lm", se = FALSE, size = 0.5, col = mypal[13])+
  theme_minimal()+
  labs(y = "log(PSR)", x = "log(WOS Citations)")+
  labs(title = "WOS Citations vs PSR (Species)")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")

ggsave("figures/PSR/species.pdf",
       plot = p1,
       units = "in",
       width = 4,
       height = 4,
       useDingbats = FALSE)


# Genus + species plot
genus_genus$group = "Genus"
species_species$group = "Species"
p3 <- rbind(species_species, genus_genus) %>% 
  group_by(host) %>% 
  summarize(PSR = n(), WOS = WOS, group = group) %>%
  ggplot(aes(x = log(WOS), y = log(PSR), col = group)) +
  geom_point(size = 3)+
  scale_colour_manual(values = mypal[c(9,13)])+
  geom_smooth(aes(group = group), method = "lm", se = FALSE, size = 0.5)+
  theme_minimal()+
  labs(y = "log(PSR)", x = "log(WOS Citations)", col = "taxonomy level")+
  labs(title = "WOS Citations vs PSR")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "bottom")

ggsave("figures/PSR/both.pdf",
       plot = p3,
       units = "in",
       width = 4,
       height = 4,
       useDingbats = FALSE)
```

```{r Visualize pathogen sharing}
# Genus host, genus pathogen
p1 <- genus_all %>%
  filter(shared.org > 0) %>%
  ggplot(aes(x = shared.org))+
  geom_density(fill = mypal[9])+
  theme_minimal()+
  labs(y = "Count", x = "Proportion Shared")+
  labs(title = "Host pathogen sharing (Genus-Genus)")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")
ggsave("figures/JAC/genus.pdf",
       plot = p1,
       units = "in",
       width = 2,
       height = 2,
       useDingbats = FALSE)


# Species host, species pathogen
p2 <- species_all %>%
  filter(shared.org > 0) %>%
  ggplot(aes(x = shared.org))+
  geom_density(fill = mypal[13])+
  theme_minimal()+
  labs(y = "Count", x = "Proportion Shared")+
  labs(title = "Host pathogen sharing (Species-Species)")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")
ggsave("figures/JAC/species.pdf",
       plot = p2,
       units = "in",
       width = 2,
       height = 2,
       useDingbats = FALSE)
```

```{r Proportion vs WOS + Distance}
# Run regression
mylm <- lm(shared.org ~ WOS + distance, species_all)
predicted <- mylm %>% predict(species_all)

# Species Prediction
spec_predict <- as.data.frame(cbind(species_all$shared.org, predicted))

summary(mylm)

ggplot(spec_predict, aes(x = V1, y = predicted))+
  geom_point()+
  geom_smooth(method = "lm")+
  theme_minimal()+
  labs(x = "True shared", y = "Predicted shared")+
  labs(title = "Shared.org ~ WOS + distance")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

```

```{r Proportion vs. Distance Boxplots}
# Species plot
p1 <- species_all %>% 
  filter(shared.org > 0) %>%
  ggplot(aes(x = as.factor(distance), y = shared.org)) +
  geom_boxplot(aes(fill = as.factor(distance)))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Species-Species)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BOX/species.pdf",
       plot = p1,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Species-genus plot
p1a <- species_genus_all %>% 
  filter(shared.org > 0) %>%
  ggplot(aes(x = as.factor(distance), y = shared.org)) +
  geom_boxplot(aes(fill = as.factor(distance)))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Species-Genus)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BOX/species.gen.pdf",
       plot = p1a,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Genus plot
p2 <- genus_all %>% 
  filter(shared.org > 0) %>%
  ggplot(aes(x = as.factor(distance), y = shared.org)) +
  geom_boxplot(aes(fill = as.factor(distance)))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Genus-Genus)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BOX/genus.pdf",
       plot = p2,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Genus plot phylogeny
p2a <- genus_species_all %>% 
  filter(shared.org > 0) %>%
  ggplot(aes(x = as.factor(distance), y = shared.org)) +
  geom_boxplot(aes(fill = as.factor(distance)))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Genus-Species)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BOX/genus.sp.pdf",
       plot = p2a,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

```

```{r Genus Phylogeny}
# Genus plot phylogeny
p <- genus_all.p %>% 
  filter(shared.org > 0) %>%
  ggplot(aes(x = distance, y = shared.org)) +
  geom_point(col = mypal[2])+
  geom_smooth(method = "lm", se = FALSE, color = "black", lwd = 0.5)+
  theme_minimal()+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Genus-Genus)")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
       # axis.title.x = element_text(size = 12, face = "bold"),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        legend.position = "none")

ggsave("figures/DOT/genus.pdf",
       plot = p,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)


# Regression
mylm <- lm(shared.org ~ distance + WOS, genus_all.p)
summary(mylm)
```

```{r Proportion vs. Distance Dist}
# Species plot
p1 <- species_all %>% 
  filter(shared.org > 0)%>% 
  ggplot(aes(x = shared.org, col = as.factor(distance))) +
  geom_density()+
  theme_minimal()+
  scale_colour_manual(values = mypal)+
  labs(x = "Proportion Pathogens Shared", col = "Distance" )+
  labs(title = "Pathogen sharing distribution (Species-Species)", col = "Phylogenetic Distance")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "bottom")
  

ggsave("figures/DIS/species.pdf",
       plot = p1,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Species-genera plot
p1a <- species_genus_all %>% 
  filter(shared.org > 0)%>% 
  ggplot(aes(x = shared.org, col = as.factor(distance))) +
  geom_density()+
  theme_minimal()+
  scale_colour_manual(values = mypal)+
  labs(x = "Proportion Pathogens Shared", col = "Distance" )+
  labs(title = "Pathogen sharing distribution (Species-Genus)", col = "Phylogenetic Distance")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "bottom")
  

ggsave("figures/DIS/species.gen.pdf",
       plot = p1a,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Genus plot
p2 <- genus_all %>% 
  filter(shared.org > 0)%>% 
  ggplot(aes(x = shared.org, col = as.factor(distance))) +
  geom_density()+
  theme_minimal()+
  scale_colour_manual(values = mypal)+
  labs(x = "Proportion Pathogens Shared", col = "Distance" )+
  labs(title = "Pathogen sharing distribution (Genus-Genus)", col = "Phylogenetic Distance")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "bottom")
  

ggsave("figures/DIS/genus.pdf",
       plot = p2,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Genus-species plot
p2a <- genus_species_all %>% 
  filter(shared.org > 0)%>% 
  ggplot(aes(x = shared.org, col = as.factor(distance))) +
  geom_density()+
  theme_minimal()+
  scale_colour_manual(values = mypal)+
  labs(x = "Proportion Pathogens Shared", col = "Distance" )+
  labs(title = "Pathogen sharing distribution (Genus-Species)", col = "Phylogenetic Distance")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "bottom")
  

ggsave("figures/DIS/genus.sp.pdf",
       plot = p2a,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)
```

```{r Proportion vs. Distance Barplots}
# Species plot
p1 <- species_all %>% 
  group_by(distance) %>%
  summarize(mean.shared = mean(shared.org), sd = sd(shared.org)) %>% 
  ggplot(aes(x = as.factor(distance), y = mean.shared, fill = as.factor(distance))) +
  geom_bar(stat = "identity", color = "black", 
           position = position_dodge()) +
  geom_errorbar(aes(ymin = mean.shared-sd, 
                    ymax = mean.shared+sd),
                    width = 0.2,
                    position = position_dodge(0.9))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Species-Species)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BAR/species.pdf",
       plot = p1,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Species-genus plot
p1a <- species_genus_all %>% 
  group_by(distance) %>%
  summarize(mean.shared = mean(shared.org), sd = sd(shared.org)) %>% 
  ggplot(aes(x = as.factor(distance), y = mean.shared, fill = as.factor(distance))) +
  geom_bar(stat = "identity", color = "black", 
           position = position_dodge()) +
  geom_errorbar(aes(ymin = mean.shared-sd, 
                    ymax = mean.shared+sd),
                    width = 0.2,
                    position = position_dodge(0.9))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Species-Genus)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BAR/species.gen.pdf",
       plot = p1a,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Genus plot
p2 <- genus_all %>% 
  group_by(distance) %>%
  summarize(mean.shared = mean(shared.org), sd = sd(shared.org)) %>% 
  ggplot(aes(x = as.factor(distance), y = mean.shared, fill = as.factor(distance))) +
  geom_bar(stat = "identity", color = "black", 
           position = position_dodge()) +
  geom_errorbar(aes(ymin = mean.shared-sd, 
                    ymax = mean.shared+sd),
                    width = 0.2,
                    position = position_dodge(0.9))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Genus-Genus)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BAR/genus.pdf",
       plot = p2,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)

# Genus-speciesplot
p2a <- genus_species_all %>% 
  group_by(distance) %>%
  summarize(mean.shared = mean(shared.org), sd = sd(shared.org)) %>% 
  ggplot(aes(x = as.factor(distance), y = mean.shared, fill = as.factor(distance))) +
  geom_bar(stat = "identity", color = "black", 
           position = position_dodge()) +
  geom_errorbar(aes(ymin = mean.shared-sd, 
                    ymax = mean.shared+sd),
                    width = 0.2,
                    position = position_dodge(0.9))+
  theme_minimal()+
  scale_fill_manual(values = mypal)+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Genus-Species)")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10),
        legend.position = "none")

ggsave("figures/BAR/genus.sp.pdf",
       plot = p2a,
       units = "in",
       width = 6,
       height = 6,
       useDingbats = FALSE)
```

```{r Trophic Bin}
p1 <- bin_genus_all %>% 
  filter(bin %in% c('B','N/H', 'H', 'B/H', 'N')) %>%
  ggplot( aes(x = distance, y = shared.org))+
  geom_point(aes(col = bin, alpha = 0.4))+
  geom_smooth(method = "lm", se = FALSE, col = "black", lwd = 0.3)+
  facet_wrap(~bin, nrow = 1)+
  theme_minimal() +
  scale_colour_manual(values = mypal[-2])+
  labs(y = "Proportion Pathogens Shared", x = "Phylogenetic Distance")+
  labs(title = "Pathogen sharing vs. Distance (Genus-Genus)")+
  theme(#plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        #axis.title.y = element_text(size = 12, face = "bold"),
        #axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12),
        plot.title = element_blank(),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none")

ggsave("figures/BIN/genus.pdf",
       plot = p1,
       units = "in",
       width = 10,
       height = 2.5,
       useDingbats = FALSE)

# Get coefficients by bin
spl <- with(bin_genus_all, split(bin_genus_all, list(bin = bin)))

coefLM <- function(x) {
  coef(lm(shared.org ~ distance, data = x))[2]
}

coefs <- sapply(spl, coefLM) %>% as.data.frame() %>% rename('coef' = '.')
coefs$bin <-stringr::str_replace(rownames(coefs), ".distance", "")

p2 <- coefs %>% filter(bin %in% c('B','N/H', 'H', 'B/H', 'N')) %>%
  ggplot(aes(x = reorder(bin, coef), y = coef, fill = as.factor(bin))) +
  geom_bar(stat = "identity", color = "black", 
           position = position_dodge()) +
  theme_minimal()+
  geom_text(aes(label = round(coef, 3)), vjust = -1)+
  scale_fill_manual(values = mypal[-2])+
  labs(y = "Distance Coefficient", x = "Trophic Bin")+
  labs(title = "Pathogen sharing vs. Distance by trophic Bin")+
  theme(plot.title = element_text(hjust = 0.5, size = 13, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 10, face = "bold"),
        axis.text.y = element_text(size = 10, face = "bold"),
        legend.position = "none")

ggsave("figures/BIN/genus.coef.pdf",
       plot = p2,
       units = "in",
       width = 8,
       height = 4,
       useDingbats = FALSE)
```

