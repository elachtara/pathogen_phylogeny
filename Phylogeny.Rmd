---
title: "Phylogeny"
author: "Emily M. Lachtara"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load required packages
library(readxl)
library(janitor)
library(dplyr)
library(ggplot2)
library(tidyr)
library(kableExtra)
library(readxl)
library(readr)
 source('functions/Cladogram.R')

# Define color pallette
mypal <- cbind(palette(RColorBrewer::brewer.pal(n = 8, name = "Set2")),
               palette(RColorBrewer::brewer.pal(n = 12, name = "Paired")))
```

```{r Data wrangle}
# Read in Data
cladogram <- read_excel("data/phylo/cladogram.xlsx", sheet = "Sheet1") %>% clean_names() %>% select(-notes)

# Load in clean data if needed
load("data/clean_pathogen.rda")
# split up into species genus
justnames <- species_species %>% 
  separate(host, c('genus', 'species') , sep = " ") %>%
  select(genus, species) %>%
  mutate(gspec = paste(genus, species, sep = " "))

# join into cladogram9
phylo_dist <- full_join(justnames, cladogram, by = "genus")  %>%  na.omit() %>% distinct()
save(phylo_dist, file = "data/phylo/joined_dist.rda")

# Run clado distances for species
load("data/phylo/joined_dist.rda")
get_cladogram(data = phylo_dist, "data/phylo/species.dist.rda")

colnames(distmat) <- c("org1", "org2", "distance")
distmat <- as.data.frame(distmat)
save(distmat, file = "data/phylo/species.dist.rda")
```